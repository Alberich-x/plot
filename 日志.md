# 数据显示

## 已完成功能

1. 绘制horizon虚线, 规格为9像素实线, 5像素空白, 颜色为#787878
2. 绘制vertical刻度线, 规格为每格5刻度, 刻度长度为3像素, 颜色为#C0C0C0, 同时刻度线间隔相同
3. 将绘制图片加入scrollView中
4. 重写所有Button功能, 实现获取当前的event的位置
5. 通过重写Button实现框选功能
6. 新建MyGraphicsView类, 继承QGraphicsView类, 重写按钮实现框选
7. 可通过鼠标事件获取view内坐标, 后续可以实现缩放等功能

## 备忘

1. 将所有的horizon虚线定义为可修改, 用于拖动右侧条.
2. 将所有的vertical刻度线调整为相同间距(还没确认好)
3. 通过鼠标获取的坐标进行缩放
4. measure功能, 通过勾选右侧的类型, 选择相同x轴的两个点, 并计算距离.
5. 读入数据时需要在顶部实现距离相关刻度线.
6. 将绘制图片功能封装进MyGraphicsView类内.
7. 图片大小将由计算数据获得.
8. 每个整数刻度都将绘制一条粗刻度线, 颜色为#000000.
9. 下周实现分析数据并绘制。

# 4.1

## 新增问题

1. 图表为矢量图, 并非pixmap, 需要重置图表.
2. 目前计划为重写, 之后可能会在外部重绘
3. 设想:隐藏原先的坐标图, 根据缩放系数重绘一张坐标图
4. 使用QCusetomePlot



# 重要

## 更改了qCustomPlot的wheelEvent事件，新增了一个if用于触发ctrl+wheel

1. 加入了  *if (event->modifiers() & Qt::ControlModifier)*

## 试图通过PressEvent事件改写wheelEvent事件



## tips

1. grid用来改变网格样式
2. 可以在整体的customePlot里进行修改而不是子类AxisRect内修改

# 4.2

## 完成

1. 完成了图表绘制以及使用贝塞尔函数绘制曲线, 并进行了程序规划

## 待完成

1. 将图像存入vector
2. 坐标轴缩放

# 4.7

## 已完成

1. 数据导入, 绘制曲线等, 缩放后的重新绘制坐标轴等需要完成
2. 新增计算最小包围矩形函数: *CaculateMinRect()*

3. 替换计算公式, 更改变量名, 使更直观

4. 完成了初始定位

## 待完成 

1. ratio比例存在问题, 应该是图片相关
2. line_iter存在些微误差, 放大时可看出
3. hline的新scene绘制
4. 大量数据的适配
5. 解决切换程序后的笔触消失

# 4.8

## 已解决

1. 确认算法没有问题, 包括点位计算, 间隔, 比例, 虚线绘制等

## 未解决

1. 算法没有问题, 但是会出现*fitInView*之后的比例并不正确,
2. 之后会规划的数据会随着框体进行横向缩放

# 4.9

## 今日工作

1. 学习使用git, 使用图形化页面和命令行模式
2. 整理成文档, 写成pdf, 
3. 对当前比例进行反推, 得到更精确的图形

## 今日问题

1. 无法解决完全与远啦爹坐标轴对齐, 因为graphicsview的问题
2. 仔细查询软件发现的缩放后图形像素需要发生变化, 依旧使用贝塞尔曲线

## 预改动

1. 将直接根据缩放的大小进行重新绘制所有的图片, 还是以确认好的interval为中心轴重绘
2. 重绘的时机为release之后
3. 重绘将重绘框住图形的加上上下两级基准线一起重绘
4. 重绘图像将与重绘viewPort上的坐标轴一起进行
5. 将viewpath保存为类的私有变量

# 4.11

## 上午工作

1. 观察现场
2. 对现场进行照相留档
3. 对相片制成pdf

## 图片绘制

1. 根据框选大小进行重绘
2. 要考虑x轴的重绘

# 代码改动

1. struct data_set改动, 将只记录数据point, height将放在绘制图片时计算.
2. 缩放重绘将按原图比例, 还需要限定最小可缩放像素.

# 4.12

## 预改动

1. 使缩放后的图像比例正确
2. 使缩放后的图像位置为框选位置
3. 滚轮修改
4. 缩放图片放入单独的scene中而不是viewport上
5. 计划将垂直刻度线也放入绘制清单内
6. 计划提高效率, 现有放大时会卡顿的问题

# 4.12

## 存在问题

1. viewport坐标轴和scene坐标轴不一致, 需要mapToScene或者其他替代方案
2. 存在卡顿等

## 解决方案汇总

### 使用mapToScene对每个关键点位进行一次mapToScne

1. viewport左上角
2. height_each
3. 使用ratio后的first_line

### 另一种解决方法

1. 使用mapToScene(path), 并直接显示

# 4.13



# 4.16

1. 将scene的初始坐标移到了左上角， 解决了比例问题

## 现存问题

1. 重绘后的虚线需要进行滚轮才可以显示, 需要进行修改.(解决, 用connect绑定scene事件)
2. 重绘时间有些长, 需要进行更改
2. 返回原来界面时的位置没有确定

# 4.17

## 今日待解决:

1. 需要解决缩放以及还原时的窗口位置问题(解决, 不过存在进度条会变成负数的问题.)
2. 设计是否放大按钮(完成)， 设计测量功能， 设计上方测量条
3. 在完成以上后， 设计右侧按钮拖动

# 4.18

## 今日待完成

1. 继续完善测量功能
2. 设计坐标轴
3. 反向画图存在问题

## 算法逻辑

1. 通用解和特殊解
2. 通用解: 自动计算点位
3. 特殊解: 手动计算大致范围

